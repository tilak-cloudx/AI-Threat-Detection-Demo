# ml_model.py
import os
import pandas as pd
import joblib

model_path = os.path.join(os.path.dirname(__file__), "model", "trained_model.pkl")
model = joblib.load(model_path)

def predict_threat(features: dict):
    df = pd.DataFrame([features])
    prediction = model.predict(df)[0]
    return prediction
